load("/media/sf_ucsf/ampAnalysis.RData")
load("~/examples.desktop")
library(readr)
falconx_path <- '/media/sf_ucsf/myCostelloLab/falconx/'
gene_bounds <- read.delim(paste0(falconx_path, 'hg19_GencodeCompV19_geneid_gene_boundaries.txt'),
header = FALSE, stringsAsFactors = FALSE)
colnames(gene_bounds) <- c('gene', 'start', 'end', 'chr')
gene_bounds$chr <- sapply(gene_bounds$chr, parse_number)
gene_bounds$chr <- replace(gene_bounds$chr, is.na(gene_bounds$chr), 'X')
cn_group_files <- list.files(paste0(falconx_path, 'Patient413/'), pattern = 'cn_filtered_groups')
test_f <- 'Patient413_chr1_cn_filtered_groups.txt'
test <- read.delim(paste0(falconx_path, 'Patient413/', test_f))
str_extract(test_f, 'chr[0-9]+')
library(dplyr)
library(plyr)
library(ggplot2)
library(gridExtra)
library(stringr)
library(reshape2)
library(grid)
test_f <- 'Patient413_chr1_cn_filtered_groups.txt'
test <- read.delim(paste0(falconx_path, 'Patient413/', test_f))
str_extract(test_f, 'chr[0-9]+')
head(gene_bounds)
gene_bounds <- gene_bounds[with(gene_bounds, order(chr,start)),]
head(gene_bounds)
c(c('one', 'two'), 'three')
sapply(gene_bounds, function(x) x$['start'] > 0 & x$['end'] > 0)
sapply(gene_bounds, function(x) x['start'] > 0 & x['end'] > 0)
apply(gene_bounds, 1, function(x) x['start'] > 0 & x['end'] > 0)
apply(gene_bounds, 1, function(x) x$start > 0 & x$end > 0)
apply(gene_bounds, 1, function(x) x['start'] > 0 & x['end'] > 0)
head(gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
mapped_genes <- as.vector(chr_genes[r,]$gene)
return(mapped_genes)
}
map_genes_to_range(1,1000,12000000, gene_bounds)
map_genes_to_range(1,1000,1200000, gene_bounds)
map_genes_to_range(1,1000,120000, gene_bounds)
map_genes_to_range(1,1000,12000, gene_bounds)
map_genes_to_range(1,1000,1200, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
print(head(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
return(mapped_genes)
}
map_genes_to_range(1,1000,1200, gene_bounds)
test <- map_genes_to_range(1,1000,1200, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
print(head(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,1200, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,1200, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,12000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- apply(chr_genes, 1, function(x) x['start'] > seg_start & x['end'] < seg_end)
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,120000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- chr_genes['start'] > seg_start & chr_genes['end'] < seg_end
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,120000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- chr_genes$start > seg_start & chr_gene$end < seg_end
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,120000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- chr_genes$start > seg_start & chr_genes$end < seg_end
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,120000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- chr_genes$start > seg_start & chr_genes$end < seg_end
print(head(r))
print(table(r))
mapped_genes <- as.vector(chr_genes[r,]$gene)
print(length(mapped_genes))
return(mapped_genes)
}
test <- map_genes_to_range(1,1000,1200000, gene_bounds)
map_genes_to_range <- function(chr, seg_start, seg_end, gene_bounds){
#' Finds genes within a region on a chromosome
chr_genes <- gene_bounds[gene_bounds$chr==chr,]
r <- chr_genes$start > seg_start & chr_genes$end < seg_end
mapped_genes <- as.vector(chr_genes[r,]$gene)
return(mapped_genes)
}
map_genes_to_range(1,1000,1200000, gene_bounds)
cn_group_413 <- data.frame(matrix(ncol = 8, nrow = 0))
colnames(cn_group_413) <- c('tauhat', 'start', 'end', 'tumorZID', 'cns1', 'cns2', 'group', 'chr')
for (f in cn_group_files){
temp <- read.delim(paste0(falconx_path, 'Patient413/', f))
temp$chr <- gsub('chr', '', str_extract(f, 'chr[0-9]+'))
cn_group_413 <- rbind(cn_group_413, temp)
}
cn_group_413
test <- map_genes_to_range(1,1000,1200000, gene_bounds)
test
as.character(test)
paste(test, collapse = ',')
setwd("/media/sf_ucsf/myCostelloLab/3DGliomaAtlas")
sampleData <- readRDS("data/datasets/sampledata_v7.rds")
tumorData <- readRDS("data/datasets/tumordata_v7.rds")
list.files()
sampleData <- readRDS("data/metadata/sampledata_v7.rds")
tumorData <- readRDS("data/metadata/tumordata_v7.rds")
head(sampleData)
head(tumorData)
test <- readRDS("data/datasets/Patient260/sf11294/rna.rds")
head(test)
withRNA <- sampleData$Patient[!is.na(sampleData$RNAseq_ColRaw)]
withRNA
withRNA <- unique(sampleData$Patient[!is.na(sampleData$RNAseq_ColRaw)])
withRNA
shiny::runApp('/media/sf_ucsf/myCostelloLab/shiny/census-app')
runApp()
runApp()
runApp()
runApp()
sampleData <- readRDS("data/metadata/sampledata_v7.rds")
tumorData <- readRDS("data/metadata/tumordata_v7.rds")
runApp()
withRNA <- unique(sampleData$Patient[!is.na(sampleData$RNAseq_ColRaw)])
withRNA
runApp('/media/sf_ucsf/myCostelloLab/shiny/dynamicUI')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp('/media/sf_ucsf/myCostelloLab/shiny/dynamicUI')
runApp('/media/sf_ucsf/myCostelloLab/3DGliomaAtlas')
runApp()
runApp()
withRNA
as.list(withRNA)
unlist(withRNA)
as.vector(withRNA)
withRNA <- as.vector(unique(sampleData$Patient[!is.na(sampleData$RNAseq_ColRaw)]))
runApp()
sort(withRNA)
withRNA <- sort(as.vector(unique(sampleData$Patient[!is.na(sampleData$RNAseq_ColRaw)])))
runApp()
runApp()
runApp()
head(sampleData)
patientSFNum <- sampleData[,c('Patient','SFNumber')]
unique(patientSFNum)
patientSFNum <- unique(sampleData[,c('Patient','SFNumber')])
patientSFNum
runApp()
runApp()
runApp('/media/sf_ucsf/myCostelloLab/shiny/dynamicUI')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
source('/media/sf_ucsf/myCostelloLab/3DGliomaAtlas/scripts/tabs/dataTab.R')
runApp()
runApp('/media/sf_ucsf/myCostelloLab/shiny')
runApp()
source('/media/sf_ucsf/myCostelloLab/3DGliomaAtlas/scripts/tabs/dataTab.R')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
get(input$patient)
runApp()
runApp()
runApp()
lower("RNA")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
setwd("/media/sf_ucsf/myCostelloLab/3DGliomaAtlas")
runApp()
runApp()
runApp()
runApp()
runApp()
data <- readRDS('data/datasets/Patient260/sf11294/rna.rds')
rownames(data)
rownames(data)[1]
runApp()
colnames(data)
runApp()
runApp()
list(rownames(data))
as.vector(rownames(data))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
as.character(data)
head(DATA)
